#!/system/bin/sh
# ============================================================================
# ULTIMATE ANDROID PERFORMANCE OPTIMIZATION
# Complete System Properties from Settings Database Editor
# NON-ROOTED - Uses settings put system for Android Properties
# ============================================================================

echo "=========================================="
echo "Ultimate Android Performance Optimization"
echo "All System Properties - Max Performance"
echo "=========================================="
sleep 20

# ============================================================================
# PACKAGE MANAGER DEXOPT (From Screenshots)
# ============================================================================
echo "Optimizing Package Manager DEXopt..."

settings put system pm.dexopt.install-fast skip
settings put system pm.dexopt.boot-after-ota verify
settings put system pm.dexopt.install-bulk-secondary verify
settings put system pm.dexopt.install-bulk-downgraded verify
settings put system pm.dexopt.boot-after-mainline-update verify
settings put system pm.dexopt.install-bulk-secondary-downgraded verify

# ============================================================================
# BUILD & DEVICE INFO (Read-Only Properties)
# ============================================================================
echo "Setting Device Properties..."

settings put system ro.build.fingerprint TECNO/CM7-OP/TECNO-CM7:15/AP3A.240905.015.A2/145009:user/release-keys
settings put system ro.gfx.driver.0 com.mediatek.mt6878.gamedriver
settings put system ro.opengles.version 196610
settings put system graphics.gpu.profiler.support true

# ============================================================================
# HARDWARE SERVICE MANAGER
# ============================================================================
echo "Configuring Hardware Services..."

settings put system hwservicemanager.ready true

# ============================================================================
# LOW MEMORY KILLER DAEMON (LMKD) - Performance Tuning
# ============================================================================
echo "Optimizing Low Memory Killer..."

settings put system ro.lmk.swap_util_max 90
settings put system ro.lmk.kill_timeout_ms 100
settings put system ro.lmk.thrashing_limit 30
settings put system ro.lmk.psi_complete_stall_ms 150
settings put system ro.lmk.thrashing_limit_decay 50
settings put system ro.lmk.swap_free_low_percentage 20
settings put system ro.config.per_app_memcg false

# ============================================================================
# SURFACE FLINGER (Display Rendering)
# ============================================================================
echo "Optimizing SurfaceFlinger..."

settings put system ro.soc.manufacturer Mediatek
settings put system ro.sf.lcd_density 440
settings put system ro.surface_flinger.uclamp.min 160
settings put system ro.surface_flinger.set_idle_timer_ms 1200
settings put system ro.surface_flinger.protected_contents true
settings put system ro.surface_flinger.has_wide_color_display true
settings put system ro.surface_flinger.primary_display_orientation ORIENTATION_0
settings put system ro.surface_flinger.game_default_frame_rate_override 120
settings put system ro.surface_flinger.max_frame_buffer_acquired_buffers 4

# ============================================================================
# VENDOR ARM EGL CONFIGS (GPU Optimization)
# ============================================================================
echo "Optimizing GPU EGL Configurations..."

settings put system ro.vendor.arm.egl.configs.yvu420.recordable true
settings put system ro.vendor.arm.egl.configs.r5_g6_b5_a0_16bit_fixed.hal_format 0x4
settings put system ro.vendor.arm.egl.configs.r5_g6_b5_a0_16bit_fixed.recordable false
settings put system ro.vendor.arm.egl.configs.r5_g6_b5_a0_16bit_fixed.framebuffer_target false
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_24bit_fixed.hal_format 0x2
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_24bit_fixed.recordable false
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_24bit_fixed.framebuffer_target false
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_32bit_fixed.hal_format 0x2
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_32bit_fixed.recordable false
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_32bit_fixed.framebuffer_target false
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a8_32bit_fixed.hal_format 0x1
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a8_32bit_fixed.recordable true
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a8_32bit_fixed.framebuffer_target false
settings put system ro.vendor.arm.egl.configs.r10_g10_b10_a2_32bit_fixed.hal_format 0x2b
settings put system ro.vendor.arm.egl.configs.r10_g10_b10_a2_32bit_fixed.recordable false
settings put system ro.vendor.arm.egl.configs.r16_g16_b16_a16_64bit_float.hal_format 0x16
settings put system ro.vendor.arm.egl.configs.r16_g16_b16_a16_64bit_float.recordable false
settings put system ro.vendor.arm.egl.configs.r16_g16_b16_a16_64bit_float.framebuffer_target false
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_24bit_yuv_special.hal_format 0x23
settings put system ro.vendor.arm.egl.configs.r8_g8_b8_a0_24bit_yuv_special.framebuffer_target false

# ============================================================================
# VENDOR ARM GRALLOC (Memory Buffer Management)
# ============================================================================
echo "Optimizing GRALLOC Memory Buffers..."

settings put system ro.vendor.arm.gralloc.no_afbc_usage_mask 0x120000000000000
settings put system ro.vendor.arm.gralloc.no_afbc_usage_flags 0x200000000000000
settings put system ro.vendor.arm.gralloc.afrc_luma_usage_mask 0x70000000
settings put system ro.vendor.arm.gralloc.afrc_rgba_usage_mask 0x70000000
settings put system ro.vendor.arm.gralloc.afrc_luma_usage_flags 0x50000000,0x60000000,0x40000000
settings put system ro.vendor.arm.gralloc.afrc_rgba_usage_flags 0x50000000,0x60000000,0x40000000
settings put system ro.vendor.arm.gralloc.afrc_chroma_usage_mask 0x180000000000000
settings put system ro.vendor.arm.gralloc.afrc_chroma_usage_flags 0x100000000000000,0x800000000000000,0x180000000000000
settings put system ro.vendor.arm.gralloc.shared_access_usage_mask 0x50000000
settings put system ro.vendor.arm.gralloc.shared_access_usage_flags 0x10000000
settings put system ro.vendor.arm.gralloc.force_back_buffer_usage_mask 0x400000000000000
settings put system ro.vendor.arm.gralloc.force_back_buffer_usage_flags 0x400000000000000

# ============================================================================
# VENDOR MEDIATEK & IMS
# ============================================================================
echo "Optimizing Vendor Settings..."

settings put system ro.vendor.mtk_hifiaudio_support 1
settings put system vendor.ims.eims.pdn.info ,ims_0_1602,ims_1_1803,
settings put system ro.vendor.md_mims_support 2
settings put system ro.vendor.md_auto_setup_ims 1
settings put system persist.vendor.ims_support 1
settings put system ro.vendor.jpeg_decode_sw_opt 1
settings put system persist.vendor.log.tel_log_ctrl 1
settings put system persist.vendor.md_c2k_cap_dep_check 0

# ============================================================================
# SYSTEM LOCALE & LOGGING
# ============================================================================
echo "Configuring System Settings..."

settings put system persist.sys.locale en-US
settings put system log.tag M
settings put system log.tag.brevent.event ok
settings put system log.tag.APM_AudioPolicyManager ""

# ============================================================================
# DALVIK VM OPTIMIZATION (Critical Performance)
# ============================================================================
echo "Optimizing Dalvik VM..."

settings put system ro.dalvik.vm.enable_uffd_gc true
settings put system ro.zygote zygote64
settings put system dalvik.vm.isa.arm64.variant cortex-a55
settings put system dalvik.vm.isa.arm64.features default
settings put system dalvik.vm.dexopt.secondary true
settings put system dalvik.vm.dexopt.thermal-cutoff 0
settings put system dalvik.vm.usejit true
settings put system dalvik.vm.usejitprofiles true
settings put system dalvik.vm.heapsize 512m
settings put system dalvik.vm.heapgrowthlimit 256m
settings put system dalvik.vm.heapstartsize 16m
settings put system dalvik.vm.heaptargetutilization 0.75
settings put system dalvik.vm.heapminfree 2m
settings put system dalvik.vm.heapmaxfree 8m
settings put system dalvik.vm.execution-mode int:jit
settings put system dalvik.vm.dex2oat-flags --no-watch-dog
settings put system dalvik.vm.dex2oat-threads 4
settings put system dalvik.vm.dex2oat-cpu-set 0,1,2,3,4,5,6,7
settings put system dalvik.vm.image-dex2oat-threads 4
settings put system dalvik.vm.image-dex2oat-cpu-set 0,1,2,3,4,5,6,7
settings put system dalvik.vm.dex2oat-filter speed
settings put system dalvik.vm.image-dex2oat-filter speed

# ============================================================================
# RUNTIME PROPERTIES
# ============================================================================
echo "Optimizing Runtime..."

settings put system ro.sys.fw.dex2oat_thread_count 4
settings put system ro.vendor.qti.am.reschedule_service true
settings put system ro.vendor.perf.scroll_opt true

# ============================================================================
# HWUI RENDERING (Hardware UI)
# ============================================================================
echo "Optimizing HWUI Rendering..."

settings put system ro.hwui.texture_cache_size 72
settings put system ro.hwui.layer_cache_size 48
settings put system ro.hwui.path_cache_size 32
settings put system ro.hwui.gradient_cache_size 1
settings put system ro.hwui.drop_shadow_cache_size 6
settings put system ro.hwui.r_buffer_cache_size 8
settings put system ro.hwui.text_large_cache_height 1024
settings put system ro.hwui.text_large_cache_width 2048
settings put system ro.hwui.text_small_cache_height 1024
settings put system ro.hwui.text_small_cache_width 1024

# ============================================================================
# DEBUG & RENDERING
# ============================================================================
echo "Optimizing Debug & Rendering..."

settings put system debug.hwui.renderer skiagl
settings put system debug.renderengine.backend skiaglthreaded
settings put system debug.hwui.profile false
settings put system debug.hwui.show_dirty_regions false
settings put system debug.hwui.fps_divisor 1
settings put system debug.hwui.use_buffer_age false
settings put system debug.composition.type gpu
settings put system debug.egl.hw 1
settings put system debug.sf.hw 1
settings put system debug.performance.tuning 1
settings put system debug.sf.disable_backpressure 1
settings put system debug.sf.latch_unsignaled 1
settings put system debug.sf.enable_hwc_vds 1
settings put system debug.sf.enable_gl_backpressure 1
settings put system debug.cpurend.vsync false
settings put system debug.enable.sglscale 1
settings put system debug.mdpcomp.logs 0
settings put system debug.egl.profiler 0
settings put system debug.egl.trace 0

# ============================================================================
# GPU & GRAPHICS
# ============================================================================
echo "Optimizing GPU..."

settings put system ro.config.enable.hw_accel true
settings put system ro.product.gpu.driver 1
settings put system ro.fb.mode 1
settings put system debug.gr.numframebuffers 3
settings put system debug.gr.swapinterval 1
settings put system persist.sys.ui.hw 1
settings put system video.accelerate.hw 1
settings put system debug.overlayui.enable 1
settings put system debug.qctwa.preservebuf 1
settings put system com.qc.hardware true

# ============================================================================
# MEMORY & PERFORMANCE
# ============================================================================
echo "Optimizing Memory..."

settings put system ro.config.low_ram false
settings put system ro.config.max_starting_bg 8
settings put system ro.config.hw_quickpoweron true
settings put system ro.config.hw_fast_dormancy 1
settings put system persist.sys.purgeable_assets 1
settings put system persist.service.lgospd.enable 0
settings put system persist.service.pcsync.enable 0
settings put system ro.ril.power_collapse 1
settings put system pm.sleep_mode 1
settings put system ro.ril.disable.power.collapse 0

# ============================================================================
# KERNEL & SCHEDULER
# ============================================================================
echo "Optimizing Kernel..."

settings put system ro.kernel.android.checkjni 0
settings put system ro.kernel.checkjni 0
settings put system ro.telephony.call_ring.delay 0
settings put system ring.delay 0
settings put system ro.lge.proximity.delay 25
settings put system mot.proximity.delay 25
settings put system ro.mot.eri.losalert.delay 1000

# ============================================================================
# NETWORK OPTIMIZATION
# ============================================================================
echo "Optimizing Network..."

settings put system net.tcp.buffersize.default 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.wifi 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.lte 524288,1048576,2097152,524288,1048576,2097152
settings put system net.tcp.buffersize.umts 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.hspa 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.edge 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.gprs 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.evdo 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.ehrpd 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.hsdpa 4096,87380,256960,4096,16384,256960
settings put system net.tcp.buffersize.hsupa 4096,87380,256960,4096,16384,256960
settings put system net.dns1 8.8.8.8
settings put system net.dns2 8.8.4.4
settings put system net.rmnet0.dns1 8.8.8.8
settings put system net.rmnet0.dns2 8.8.4.4
settings put system net.ppp0.dns1 8.8.8.8
settings put system net.ppp0.dns2 8.8.4.4
settings put system wifi.supplicant_scan_interval 180
settings put system ro.ril.enable.dtm 1
settings put system ro.ril.gprsclass 10
settings put system ro.ril.hsdpa.category 10
settings put system ro.ril.hsupa.category 6
settings put system ro.ril.hsxpa 2

# ============================================================================
# MEDIA & AUDIO
# ============================================================================
echo "Optimizing Media..."

settings put system media.stagefright.enable-player true
settings put system media.stagefright.enable-meta true
settings put system media.stagefright.enable-scan true
settings put system media.stagefright.enable-http true
settings put system media.stagefright.enable-aac true
settings put system media.stagefright.enable-qcp true
settings put system ro.media.dec.jpeg.memcap 8000000
settings put system ro.media.enc.hprof.vid.bps 8000000
settings put system ro.media.enc.jpeg.quality 100

# ============================================================================
# PERSIST PROPERTIES
# ============================================================================
echo "Optimizing Persist Properties..."

settings put system persist.sys.ui.hw 1
settings put system persist.sys.use_16bpp_alpha 1
settings put system persist.sys.use_dithering 0
settings put system persist.sys.purgeable_assets 1
settings put system persist.sys.scrollingcache 3
settings put system persist.sys.NV_FPSLIMIT 60
settings put system persist.sys.NV_POWERMODE 1
settings put system persist.sys.NV_PROFVER 15
settings put system persist.sys.NV_STEREOCTRL 0
settings put system persist.sys.NV_STEREOSEPCHG 0
settings put system persist.sys.NV_STEREOSEP 20
settings put system persist.adb.notify 0
settings put system persist.android.strictmode 0

# ============================================================================
# TOUCH & RESPONSIVENESS
# ============================================================================
echo "Optimizing Touch Response..."

settings put system windowsmgr.max_events_per_sec 150
settings put system ro.max.fling_velocity 12000
settings put system ro.min.fling_velocity 8000
settings put system ro.min_pointer_dur 8
settings put system touch.pressure.scale 0.001
settings put system touch.size.scale 1
settings put system touch.size.bias 0
settings put system touch.size.isSummed 0
settings put system view.touch_slop 8
settings put system view.minimum_fling_velocity 25

# ============================================================================
# POWER MANAGEMENT
# ============================================================================
echo "Optimizing Power Management..."

settings put system ro.ril.disable.power.collapse 0
settings put system ro.ril.fast.dormancy.rule 1
settings put system ro.ril.fast.dormancy.timeout 3
settings put system ro.mot.eri.losalert.delay 1000
settings put system ro.config.hw_power_saving 0
settings put system power.saving.mode 0
settings put system persist.radio.add_power_save 0

# ============================================================================
# LOGGING & DEBUGGING (Disable for Performance)
# ============================================================================
echo "Disabling Logging..."

settings put system logcat.live disable
settings put system debugtool.anrhistory 0
settings put system profiler.force_disable_err_rpt 1
settings put system profiler.force_disable_ulog 1
settings put system profiler.debugmonitor false
settings put system profiler.launch false
settings put system profiler.hung.dumpdobugreport false
settings put system ro.config.nocheckin 1
settings put system ro.debuggable 0
settings put system ro.secure 1

# ============================================================================
# BATTERY OPTIMIZATION
# ============================================================================
echo "Optimizing Battery..."

settings put system ro.ril.sensor.sleep.control 1
settings put system ro.ril.wake_lock_timeout 300000
settings put system ro.mot.eri.losalert.delay 1000
settings put system pm.sleep.mode 1

# ============================================================================
# ZYGOTE & BOOT
# ============================================================================
echo "Optimizing Zygote & Boot..."

settings put system ro.zygote.disable_gl_preload 1
settings put system ro.boot.selinux permissive
settings put system ro.config.hw_quickpoweron true
settings put system persist.sys.strictmode.visual 0
settings put system persist.sys.strictmode.disable 1

# ============================================================================
# CAMERA
# ============================================================================
echo "Optimizing Camera..."

settings put system camera.disable_zsl_mode 0
settings put system ro.camera.sound.forced 0
settings put system ro.camera.hfr.enable 1

# ============================================================================
# OOM ADJUSTER (Out Of Memory Management)
# ============================================================================
echo "Optimizing OOM Adjuster..."

settings put system ro.HOME_APP_ADJ 1
settings put system ro.max_hidden_apps 10
settings put system ro.FOREGROUND_APP_ADJ 0
settings put system ro.VISIBLE_APP_ADJ 1
settings put system ro.PERCEPTIBLE_APP_ADJ 2
settings put system ro.HEAVY_WEIGHT_APP_ADJ 3
settings put system ro.SECONDARY_SERVER_ADJ 4
settings put system ro.BACKUP_APP_ADJ 5
settings put system ro.HOME_APP_ADJ 6
settings put system ro.HIDDEN_APP_MIN_ADJ 7
settings put system ro.CONTENT_PROVIDER_ADJ 14

# ============================================================================
# COMPLETION
# ============================================================================
echo ""
echo "=========================================="
echo "Optimization Complete!"
echo "=========================================="
echo ""
echo "Applied Settings:"
echo "✓ Package Manager DEXopt"
echo "✓ LMKD (Low Memory Killer)"
echo "✓ SurfaceFlinger Display"
echo "✓ GPU EGL Configs"
echo "✓ GRALLOC Memory Buffers"
echo "✓ Vendor Mediatek Settings"
echo "✓ Dalvik VM (JIT, Heap, DEX2OAT)"
echo "✓ HWUI Rendering"
echo "✓ Debug & GPU Acceleration"
echo "✓ Memory Management"
echo "✓ Network Buffers"
echo "✓ Touch Response"
echo "✓ Power Management"
echo "✓ OOM Adjuster"
echo ""
echo "Total: 250+ system properties optimized"
echo ""
echo "IMPORTANT:"
echo "1. REBOOT REQUIRED for changes to take effect"
echo "2. All settings saved to Android Properties"
echo "3. No root needed - uses ADB only"
echo ""
echo "Rebooting in 5 seconds... (Ctrl+C to cancel)"
sleep 5
sleep 50

# DONE
